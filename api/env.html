<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Input/Output (IO)" href="io.html" /><link rel="prev" title="Neighbours" href="neighbour.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 6.1.3 and Furo 2022.12.07 -->
        <title>Environments - OpenFLY documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=91d0f0d1c444bdcb17a68e833c7a53903343c195" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/openfly.css" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">OpenFLY  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/fly_light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/fly_dark.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../user.html">User guide</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../user/building.html">Building</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/quickstart.html">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../user/config.html">Config file</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../programmer.html">Programmer guide</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../programmer/structure.html">Project Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../programmer/libfly.html">Using libFLY</a></li>
<li class="toctree-l2"><a class="reference internal" href="../programmer/hacking.html">Hacking</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../api.html">Library API reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="utility.html">Utility</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="system.html">System</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="crystal_systems.html">Crystal systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="crystal_systems.html#hypergrid">Hypergrid</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="neighbour.html">Neighbours</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Environments</a></li>
<li class="toctree-l2"><a class="reference internal" href="io.html">Input/Output (IO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="potential.html">Potentials</a></li>
<li class="toctree-l2"><a class="reference internal" href="minimise.html">Minimisers</a></li>
<li class="toctree-l2"><a class="reference internal" href="saddle.html">Saddle-points</a></li>
<li class="toctree-l2"><a class="reference internal" href="kinetic.html">Kinetics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ChangeLog-stub.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">Todo!</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/ConorWilliams/openFLY/edit/main/docs/api/env.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="environments">
<h1>Environments<a class="headerlink" href="#environments" title="Permalink to this heading">#</a></h1>
<p>Directory: <code class="docutils literal notranslate"><span class="pre">libfly/env</span></code></p>
<p>The <code class="docutils literal notranslate"><span class="pre">env</span></code> folder contains routines working with local environments. Everything is contained within the namespace <code class="docutils literal notranslate"><span class="pre">fly::env</span></code>. The local environment (LE) of an atom is the set of atoms within some neighbourhood. It is assumed in OLKMC that the mechanisms accessible to an atom are completely contained-within and solely a-function-of its LE.</p>
<section id="geometry">
<h2>Geometry<a class="headerlink" href="#geometry" title="Permalink to this heading">#</a></h2>
<p>File: <code class="docutils literal notranslate"><span class="pre">libfly/env/geometry.hpp</span></code></p>
<p>Utilities for manipulating local environments of atoms. </p>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this heading">#</a></h3>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN3fly3env8centroidE3VecRKN6system3VoSIDp1MEE">
<span id="_CPPv3IDpEN3fly3env8centroidERKN6system3VoSIDp1MEE"></span><span id="_CPPv2IDpEN3fly3env8centroidERKN6system3VoSIDp1MEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">M</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="geometry_8hpp_1a4124df2acb69783ee84fa740f4868717"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">fly</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">centroid</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN3fly3env8centroidE3VecRKN6system3VoSIDp1MEE" title="fly::env::centroid::M"><span class="n"><span class="pre">M</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="utility.html#_CPPv4N3fly3VecE" title="fly::Vec"><span class="n"><span class="pre">Vec</span></span></a><a class="headerlink" href="#_CPPv4IDpEN3fly3env8centroidE3VecRKN6system3VoSIDp1MEE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Compute the centroid of a vector of atoms, <code class="docutils literal notranslate"><span class="pre">x</span></code>. </p>
<p><p>For a set of atoms with positions <span class="math notranslate nohighlight">\(x_i\)</span> this is defined as:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\frac{1}{N} \sum_{i=1}^{N}{x_i}\]</div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – Set of atoms with the <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Position"><span class="std std-ref">Position</span></a> property. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0DpDpEN3fly3env4rmsdEdRKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE">
<span id="_CPPv3I0DpDpEN3fly3env4rmsdERKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE"></span><span id="_CPPv2I0DpDpEN3fly3env4rmsdERKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Pr</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">Position</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">M1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">M2</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="geometry_8hpp_1ad61bb8f1185606096394b415b042d18d"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">fly</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">rmsd</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0DpDpEN3fly3env4rmsdEdRKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE" title="fly::env::rmsd::M1"><span class="n"><span class="pre">M1</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0DpDpEN3fly3env4rmsdEdRKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE" title="fly::env::rmsd::M2"><span class="n"><span class="pre">M2</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">y</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><a class="headerlink" href="#_CPPv4I0DpDpEN3fly3env4rmsdEdRKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Compute the RMSD between the positions of the atoms in x and y. </p>
<p><p>The RMSD (root mean squared distance) is the sqrt of the sum of the squared distances between
atoms, for two sets of atoms with positions <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_i\)</span> this is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Delta_\text{RMSD} = \sqrt{\sum_{i=1}^N{\left\lVert x_i - y_i \right\rVert^2}}\]</div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Pr</strong> – The distance-like vector property to use as atomic position.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> – Set of atoms with the <code class="docutils literal notranslate"><span class="pre">Pr</span></code> property. </p></li>
<li><p><strong>y</strong> – Set of atoms with the <code class="docutils literal notranslate"><span class="pre">Pr</span></code> property. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00DpDpEN3fly3env5grmsdEdRK1ERKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE">
<span id="_CPPv3I00DpDpEN3fly3env5grmsdERK1ERKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE"></span><span id="_CPPv2I00DpDpEN3fly3env5grmsdERK1ERKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Pr</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">Position</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">E</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">M1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">M2</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="geometry_8hpp_1a2c7dea9f17ce28748628c65473a66e37"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">fly</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">grmsd</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00DpDpEN3fly3env5grmsdEdRK1ERKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE" title="fly::env::grmsd::E"><span class="n"><span class="pre">E</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">M</span></span>, <span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00DpDpEN3fly3env5grmsdEdRK1ERKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE" title="fly::env::grmsd::M1"><span class="n"><span class="pre">M1</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00DpDpEN3fly3env5grmsdEdRK1ERKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE" title="fly::env::grmsd::M2"><span class="n"><span class="pre">M2</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">y</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><a class="headerlink" href="#_CPPv4I00DpDpEN3fly3env5grmsdEdRK1ERKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Compute the generalised RMSD between two sets of atoms. </p>
<p><p>The generalised RMSD (root mean squared distance) between two sets of atoms, <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, is the RMSD between them after
applying the matrix transformation <code class="docutils literal notranslate"><span class="pre">M</span></code> to each atom in <code class="docutils literal notranslate"><span class="pre">x</span></code>. For two sets of atoms with positions <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_i\)</span>
this is:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Delta_\text{GRMSD} = \sqrt{\sum_{i=1}^N{\left\lVert Mx_i - y_i \right\rVert^2}}\]</div>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Pr</strong> – The distance-like vector property to use as atomic position.</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> – Set of atoms with the <code class="docutils literal notranslate"><span class="pre">Pr</span></code> property. </p></li>
<li><p><strong>y</strong> – Set of atoms with the <code class="docutils literal notranslate"><span class="pre">Pr</span></code> property. </p></li>
<li><p><strong>M</strong> – Transformation matrix. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpDpEN3fly3env10ortho_ontoE3MatRKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE">
<span id="_CPPv3IDpDpEN3fly3env10ortho_ontoERKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE"></span><span id="_CPPv2IDpDpEN3fly3env10ortho_ontoERKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">M1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">M2</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="geometry_8hpp_1a6224e18e5d6d120b78bf8e762da41f41"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">fly</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">ortho_onto</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpDpEN3fly3env10ortho_ontoE3MatRKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE" title="fly::env::ortho_onto::M1"><span class="n"><span class="pre">M1</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpDpEN3fly3env10ortho_ontoE3MatRKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE" title="fly::env::ortho_onto::M2"><span class="n"><span class="pre">M2</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">y</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="utility.html#_CPPv4N3fly3MatE" title="fly::Mat"><span class="n"><span class="pre">Mat</span></span></a><a class="headerlink" href="#_CPPv4IDpDpEN3fly3env10ortho_ontoE3MatRKN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Compute the orthogonal transformation matrix that best transforms <code class="docutils literal notranslate"><span class="pre">x</span></code> onto <code class="docutils literal notranslate"><span class="pre">y</span></code>. </p>
<p>This does not permute any of the atoms it just minimizes the RMSD between the two sets.</p>
<p><p>Effectively solves this optimisation problem:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\min_{O}{\sum_{i=1}^N{\left\lVert O x_i - y_i \right\rVert^2}} \quad \text{with} \quad OO^\intercal = I\]</div>
</div>
<p>With <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_i\)</span> the position of the <code class="docutils literal notranslate"><span class="pre">i</span></code> th atom in <code class="docutils literal notranslate"><span class="pre">x</span></code> onto <code class="docutils literal notranslate"><span class="pre">y</span></code> respectively.</p>
</p>
<p>Uses the “Kabsch algorithm” see: <a class="reference external" href="https://en.wikipedia.org/wiki/Kabsch_algorithm">https://en.wikipedia.org/wiki/Kabsch_algorithm</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Set of atoms with the <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Position"><span class="std std-ref">Position</span></a> property. </p></li>
<li><p><strong>y</strong> – Set of atoms with the <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Position"><span class="std std-ref">Position</span></a> property. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpDp0EN3fly3env15for_equiv_permsEvRN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EEdiRK1F">
<span id="_CPPv3IDpDp0EN3fly3env15for_equiv_permsERN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EEdiRK1F"></span><span id="_CPPv2IDpDp0EN3fly3env15for_equiv_permsERN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EEdiRK1F"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">M1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">M2</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">F</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="geometry_8hpp_1a07516283e48b44aea3a96d097d1f2bdf"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">fly</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">for_equiv_perms</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpDp0EN3fly3env15for_equiv_permsEvRN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EEdiRK1F" title="fly::env::for_equiv_perms::M1"><span class="n"><span class="pre">M1</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mut</span></span>, <span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpDp0EN3fly3env15for_equiv_permsEvRN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EEdiRK1F" title="fly::env::for_equiv_perms::M2"><span class="n"><span class="pre">M2</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ref</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">delta</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <a class="reference internal" href="#_CPPv4IDpDp0EN3fly3env15for_equiv_permsEvRN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EEdiRK1F" title="fly::env::for_equiv_perms::F"><span class="n"><span class="pre">F</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">f</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><a class="headerlink" href="#_CPPv4IDpDp0EN3fly3env15for_equiv_permsEvRN6system3VoSIDp2M1EERKN6system3VoSIDp2M2EEdiRK1F" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Explore equivalent permutations of atoms in two sets. </p>
<p>This function is for greedily exploring the permutations of atoms in <code class="docutils literal notranslate"><span class="pre">mut</span></code> such that, after an orthogonal transformation generated by <code class="docutils literal notranslate"><a class="reference internal" href="#geometry_8hpp_1a6224e18e5d6d120b78bf8e762da41f41"><span class="std std-ref"><span class="pre">ortho_onto()</span></span></a></code>, the <code class="docutils literal notranslate"><a class="reference internal" href="#geometry_8hpp_1a2c7dea9f17ce28748628c65473a66e37"><span class="std std-ref"><span class="pre">grmsd()</span></span></a></code> between the two sets of atoms is less than <code class="docutils literal notranslate"><span class="pre">delta</span></code>.</p>
<p><p>This effectively finds a matrix <span class="math notranslate nohighlight">\(O\)</span> and permutation <span class="math notranslate nohighlight">\(\pi\)</span> that satisfies:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\sum_{i=1}^N{\left\lVert O x_{\pi(i)} - y_i \right\rVert^2} &lt; \delta^2\]</div>
</div>
<p>Subject to the constraints:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[OO^\intercal = I \quad \text{and} \quad \pi(i) = i \,\,\,\, \forall \,\,\,\,  i &lt; n\]</div>
</div>
<p>With <span class="math notranslate nohighlight">\(x_i\)</span> and <span class="math notranslate nohighlight">\(y_i\)</span> the position of the <code class="docutils literal notranslate"><span class="pre">i</span></code> th atom in <code class="docutils literal notranslate"><span class="pre">x</span></code> onto <code class="docutils literal notranslate"><span class="pre">y</span></code> respectively.</p>
<p>Example:</p>
<div class="code highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;libfly/env/geometry.hpp&quot;</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;libfly/system/VoS.hpp&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;libfly/system/property.hpp&quot;</span>

<span class="k">using</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fly</span><span class="o">::</span><span class="n">system</span><span class="o">::</span><span class="n">VoS</span><span class="o">&lt;</span><span class="n">fly</span><span class="o">::</span><span class="n">Position</span><span class="p">,</span><span class="w"> </span><span class="n">fly</span><span class="o">::</span><span class="n">Colour</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="p">...</span><span class="w"> </span><span class="n">Args</span><span class="o">&gt;</span>
<span class="k">auto</span><span class="w"> </span><span class="n">work</span><span class="p">(</span><span class="n">Args</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="p">...)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Artificial work.</span>
<span class="p">}</span>

<span class="k">auto</span><span class="w"> </span><span class="n">count_sym</span><span class="p">(</span><span class="n">Set</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">ref</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">delta</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">//</span>
<span class="w">  </span><span class="n">Set</span><span class="w"> </span><span class="n">mut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref</span><span class="p">;</span><span class="w">  </span><span class="c1">// Make a copy of the reference set</span>

<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Explore permutations fixing the first atom.</span>
<span class="w">  </span><span class="n">fly</span><span class="o">::</span><span class="n">env</span><span class="o">::</span><span class="n">for_equiv_perms</span><span class="p">(</span><span class="n">mut</span><span class="p">,</span><span class="w"> </span><span class="n">ref</span><span class="p">,</span><span class="w"> </span><span class="n">delta</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="o">&amp;</span><span class="p">](</span><span class="n">fly</span><span class="o">::</span><span class="n">Mat</span><span class="w"> </span><span class="k">const</span><span class="o">&amp;</span><span class="w"> </span><span class="n">O</span><span class="p">,</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">rmsd</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// If this lambda is called then &quot;mut&quot; has been permuted into an equivalent</span>
<span class="w">    </span><span class="c1">// permutation. &quot;O&quot; is the matrix that maps &quot;mut&quot; onto &quot;ref&quot; such that that:</span>
<span class="w">    </span><span class="c1">//</span>
<span class="w">    </span><span class="c1">//     &quot;rmsd&quot; == grmsd(O, mut, ref) and &quot;rmsd&quot; &lt; delta.</span>

<span class="w">    </span><span class="c1">// We could now do something with &quot;rmsd&quot; and &quot;O&quot;.</span>

<span class="w">    </span><span class="n">work</span><span class="p">(</span><span class="n">O</span><span class="p">,</span><span class="w"> </span><span class="n">rmsd</span><span class="p">);</span><span class="w">  </span><span class="c1">// Suppresses warnings</span>

<span class="w">    </span><span class="c1">// We MUST NOT mutate &quot;ref&quot; or &quot;mut&quot;.</span>

<span class="w">    </span><span class="c1">// If we &quot;return true&quot; then exploration of permutations terminates.</span>
<span class="w">    </span><span class="c1">// If we &quot;return false&quot; then exploration of permutations continues.</span>

<span class="w">    </span><span class="c1">// Here we are counting all the permutations so we will return false.</span>
<span class="w">    </span><span class="n">count</span><span class="o">++</span><span class="p">;</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="w">  </span><span class="p">});</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">count</span><span class="p">;</span><span class="w">  </span><span class="c1">// The number of approximate symmetries that ref has.</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
<p><code class="docutils literal notranslate"><a class="reference internal" href="#geometry_8hpp_1a07516283e48b44aea3a96d097d1f2bdf"><span class="std std-ref"><span class="pre">for_equiv_perms()</span></span></a></code> will not permute the first <code class="docutils literal notranslate"><span class="pre">n</span></code> (== 1 in the above example) atoms in <code class="docutils literal notranslate"><span class="pre">mut</span></code>. This is useful if there exist a number of atoms who’s permutation is known.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mut</strong> – Set of atoms with the <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Position"><span class="std std-ref">Position</span></a> &amp; <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Colour"><span class="std std-ref">Colour</span></a> properties that will be permuted to match <code class="docutils literal notranslate"><span class="pre">ref</span></code>. </p></li>
<li><p><strong>ref</strong> – The reference set of atoms with the <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Position"><span class="std std-ref">Position</span></a> &amp; <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Colour"><span class="std std-ref">Colour</span></a> properties. </p></li>
<li><p><strong>delta</strong> – The maximum <code class="docutils literal notranslate"><a class="reference internal" href="#geometry_8hpp_1a2c7dea9f17ce28748628c65473a66e37"><span class="std std-ref"><span class="pre">grmsd()</span></span></a></code> between the permuted <code class="docutils literal notranslate"><span class="pre">mut</span></code> and <code class="docutils literal notranslate"><span class="pre">ref</span></code></p></li>
<li><p><strong>n</strong> – The first <code class="docutils literal notranslate"><span class="pre">n</span></code> atoms in <code class="docutils literal notranslate"><span class="pre">mut</span></code> will not be permuted. </p></li>
<li><p><strong>f</strong> – An invokable invoked with signature <code class="docutils literal notranslate"><span class="pre">(fly::Mat</span> <span class="pre">const&amp;</span> <span class="pre">O,</span> <span class="pre">double</span> <span class="pre">rmsd)</span> <span class="pre">-&gt;</span> <span class="pre">bool</span></code> called for each permutation of <code class="docutils literal notranslate"><span class="pre">mut</span></code> that matches <code class="docutils literal notranslate"><span class="pre">ref</span></code>, see the example above for details. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="geometry-class">
<h3>Geometry class<a class="headerlink" href="#geometry-class" title="Permalink to this heading">#</a></h3>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN3fly3env8GeometryE">
<span id="_CPPv3IDpEN3fly3env8GeometryE"></span><span id="_CPPv2IDpEN3fly3env8GeometryE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">Pr</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classfly_1_1env_1_1Geometry"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Geometry</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><span class="n"><span class="pre">fly</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Position</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">Colour</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4IDpEN3fly3env8GeometryE" title="fly::env::Geometry::Pr"><span class="n"><span class="pre">Pr</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4IDpEN3fly3env8GeometryE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>A <a class="reference internal" href="#classfly_1_1env_1_1Geometry"><span class="std std-ref">Geometry</span></a> models a local distribution of periodically resolved Atoms. </p>
<p>The distribution of atoms is centred on the first atom, i.e. the first atom cannot move and is always fixed during permutation operations and the centroid of the geometry is the origin.</p>
<p>A <a class="reference internal" href="#classfly_1_1env_1_1Geometry"><span class="std std-ref">Geometry</span></a> is a <code class="docutils literal notranslate"><a class="reference internal" href="system.html#classfly_1_1system_1_1VoS"><span class="std std-ref"><span class="pre">fly::system::VoS</span></span></a></code> with the default properties <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Position"><span class="std std-ref">Position</span></a> and <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Colour"><span class="std std-ref">Colour</span></a>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN3fly3env8Geometry14best_perm_ontoENSt8optionalI7GeoInfoEERKN6system3VoSIDp2TsEEdP8Geometry">
<span id="_CPPv3IDpEN3fly3env8Geometry14best_perm_ontoERKN6system3VoSIDp2TsEEdP8Geometry"></span><span id="_CPPv2IDpEN3fly3env8Geometry14best_perm_ontoERKN6system3VoSIDp2TsEEdP8Geometry"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">Ts</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classfly_1_1env_1_1Geometry_1a5a8cab7891c8b21e70e7ef16c1915105"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N3fly3env8Geometry7GeoInfoE" title="fly::env::Geometry::GeoInfo"><span class="n"><span class="pre">GeoInfo</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">best_perm_onto</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN3fly3env8Geometry14best_perm_ontoENSt8optionalI7GeoInfoEERKN6system3VoSIDp2TsEEdP8Geometry" title="fly::env::Geometry::best_perm_onto::Ts"><span class="n"><span class="pre">Ts</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">other</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">delta</span></span>, <a class="reference internal" href="#_CPPv4IDpEN3fly3env8GeometryE" title="fly::env::Geometry"><span class="n"><span class="pre">Geometry</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">scratch_best</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN3fly3env8Geometry14best_perm_ontoENSt8optionalI7GeoInfoEERKN6system3VoSIDp2TsEEdP8Geometry" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Find the best permutation of the atoms in this <a class="reference internal" href="#classfly_1_1env_1_1Geometry"><span class="std std-ref">Geometry</span></a> onto <code class="docutils literal notranslate"><span class="pre">other</span></code>. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> – The reference set of atoms with the <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Position"><span class="std std-ref">Position</span></a> &amp; <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Colour"><span class="std std-ref">Colour</span></a> properties. </p></li>
<li><p><strong>delta</strong> – The maximum <code class="docutils literal notranslate"><a class="reference internal" href="#geometry_8hpp_1a2c7dea9f17ce28748628c65473a66e37"><span class="std std-ref"><span class="pre">grmsd()</span></span></a></code> between the permuted <code class="docutils literal notranslate"><span class="pre">this</span></code> and <code class="docutils literal notranslate"><span class="pre">ref</span></code> for this operation to succeed. </p></li>
<li><p><strong>scratch_best</strong> – An optional pointer to scratch space that the algorithm can use (otherwise this function will allocate). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>std::optional&lt;GeoInfo&gt; An engaged <code class="docutils literal notranslate"><a class="reference internal" href="#structfly_1_1env_1_1Geometry_1_1GeoInfo"><span class="std std-ref"><span class="pre">GeoInfo</span></span></a></code> if a permutation was found. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env8Geometry6centreEv">
<span id="_CPPv3N3fly3env8Geometry6centreEv"></span><span id="_CPPv2N3fly3env8Geometry6centreEv"></span><span id="fly::env::Geometry::centre"></span><span class="target" id="classfly_1_1env_1_1Geometry_1ab3071473dc87a268441cd3c059706c23"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">centre</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4N3fly3env8Geometry6centreEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Shift the origin to the centroid of the atoms. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN3fly3env8Geometry12permute_ontoENSt8optionalI7GeoInfoEERKN6system3VoSIDp2TsEEd">
<span id="_CPPv3IDpEN3fly3env8Geometry12permute_ontoERKN6system3VoSIDp2TsEEd"></span><span id="_CPPv2IDpEN3fly3env8Geometry12permute_ontoERKN6system3VoSIDp2TsEEd"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">Ts</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classfly_1_1env_1_1Geometry_1a4666bb380f0fb5f463ab7f0cca28634f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N3fly3env8Geometry7GeoInfoE" title="fly::env::Geometry::GeoInfo"><span class="n"><span class="pre">GeoInfo</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">permute_onto</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN3fly3env8Geometry12permute_ontoENSt8optionalI7GeoInfoEERKN6system3VoSIDp2TsEEd" title="fly::env::Geometry::permute_onto::Ts"><span class="n"><span class="pre">Ts</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">other</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">delta</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4IDpEN3fly3env8Geometry12permute_ontoENSt8optionalI7GeoInfoEERKN6system3VoSIDp2TsEEd" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Find the first permutation of the atoms in this <a class="reference internal" href="#classfly_1_1env_1_1Geometry"><span class="std std-ref">Geometry</span></a> onto <code class="docutils literal notranslate"><span class="pre">other</span></code> within tolerance <code class="docutils literal notranslate"><span class="pre">delta</span></code>. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> – The reference set of atoms with the <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Position"><span class="std std-ref">Position</span></a> &amp; <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Colour"><span class="std std-ref">Colour</span></a> properties. </p></li>
<li><p><strong>delta</strong> – The maximum <code class="docutils literal notranslate"><a class="reference internal" href="#geometry_8hpp_1a2c7dea9f17ce28748628c65473a66e37"><span class="std std-ref"><span class="pre">grmsd()</span></span></a></code> between the permuted <code class="docutils literal notranslate"><span class="pre">this</span></code> and <code class="docutils literal notranslate"><span class="pre">ref</span></code> if this operation succeeds. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>std::optional&lt;GeoInfo&gt; An engaged <code class="docutils literal notranslate"><a class="reference internal" href="#structfly_1_1env_1_1Geometry_1_1GeoInfo"><span class="std std-ref"><span class="pre">GeoInfo</span></span></a></code> if a permutation was found. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN3fly3env8Geometry9serializeEvR7Archive">
<span id="_CPPv3I0EN3fly3env8Geometry9serializeER7Archive"></span><span id="_CPPv2I0EN3fly3env8Geometry9serializeER7Archive"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Archive</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classfly_1_1env_1_1Geometry_1a2415fd138f81d62d3d08397bc41e059c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">serialize</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN3fly3env8Geometry9serializeEvR7Archive" title="fly::env::Geometry::serialize::Archive"><span class="n"><span class="pre">Archive</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">archive</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN3fly3env8Geometry9serializeEvR7Archive" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Lib cereal serialization support. </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env8Geometry7GeoInfoE">
<span id="_CPPv3N3fly3env8Geometry7GeoInfoE"></span><span id="_CPPv2N3fly3env8Geometry7GeoInfoE"></span><span id="fly::env::Geometry::GeoInfo"></span><span class="target" id="structfly_1_1env_1_1Geometry_1_1GeoInfo"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GeoInfo</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env8Geometry7GeoInfoE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Returned by permutation methods, contains extra info about the permutation. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env8Geometry7GeoInfo1OE">
<span id="_CPPv3N3fly3env8Geometry7GeoInfo1OE"></span><span id="_CPPv2N3fly3env8Geometry7GeoInfo1OE"></span><span id="fly::env::Geometry::GeoInfo::O__Mat"></span><span class="target" id="structfly_1_1env_1_1Geometry_1_1GeoInfo_1a6534e3393df397bb26e87337cdb27665"></span><a class="reference internal" href="utility.html#_CPPv4N3fly3MatE" title="fly::Mat"><span class="n"><span class="pre">Mat</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">O</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env8Geometry7GeoInfo1OE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Orthogonal transformation required to map this onto <code class="docutils literal notranslate"><span class="pre">x</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env8Geometry7GeoInfo4rmsdE">
<span id="_CPPv3N3fly3env8Geometry7GeoInfo4rmsdE"></span><span id="_CPPv2N3fly3env8Geometry7GeoInfo4rmsdE"></span><span id="fly::env::Geometry::GeoInfo::rmsd__double"></span><span class="target" id="structfly_1_1env_1_1Geometry_1_1GeoInfo_1a5addf03195549ecf8c9a171cd4dc6b2f"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rmsd</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env8Geometry7GeoInfo4rmsdE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Equal to <code class="docutils literal notranslate"><span class="pre">grmsd(O,</span> <span class="pre">*this,</span> <span class="pre">x)</span></code>. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="heuristics">
<h2>Heuristics<a class="headerlink" href="#heuristics" title="Permalink to this heading">#</a></h2>
<p>File: <code class="docutils literal notranslate"><span class="pre">libfly/env/heuristics.hpp</span></code></p>
<p>Utilities for quickly comparing local environments without resorting to a full <code class="docutils literal notranslate"><span class="pre">Geometry::permute_onto()</span></code>. </p>
<section id="fingerprints">
<h3>Fingerprints<a class="headerlink" href="#fingerprints" title="Permalink to this heading">#</a></h3>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env11FingerprintE">
<span id="_CPPv3N3fly3env11FingerprintE"></span><span id="_CPPv2N3fly3env11FingerprintE"></span><span id="fly::env::Fingerprint"></span><span class="target" id="classfly_1_1env_1_1Fingerprint"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Fingerprint</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env11FingerprintE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>An ordered representation of the intra-atomic distances in a <a class="reference internal" href="#classfly_1_1env_1_1Geometry"><span class="std std-ref">Geometry</span></a>. </p>
<p>The fingerprint is a continuous representation that is cheap(ish)ly comparable. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3fly3env11Fingerprint5equivERK11Fingerprintd">
<span id="_CPPv3NK3fly3env11Fingerprint5equivERK11Fingerprintd"></span><span id="_CPPv2NK3fly3env11Fingerprint5equivERK11Fingerprintd"></span><span id="fly::env::Fingerprint::equiv__FingerprintCR.doubleC"></span><span class="target" id="classfly_1_1env_1_1Fingerprint_1a7450d725d7b50d70794299ab8c7ab627"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">equiv</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N3fly3env11FingerprintE" title="fly::env::Fingerprint"><span class="n"><span class="pre">Fingerprint</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">other</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">delta</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><a class="headerlink" href="#_CPPv4NK3fly3env11Fingerprint5equivERK11Fingerprintd" title="Permalink to this definition">#</a><br /></dt>
<dd><p>A fast test to see if two local environments <strong>may</strong> be equivalent. </p>
<p>Explicitly, for the LE this fingerprint represents, this function must return <code class="docutils literal notranslate"><span class="pre">true</span></code> if the LE is able to be <code class="docutils literal notranslate"><span class="pre">permute_onto()</span></code> other with the same <code class="docutils literal notranslate"><span class="pre">delta</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>other</strong> – The other fingerprint. </p></li>
<li><p><strong>delta</strong> – The tolerance for the equivalence. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">true</span></code> If two local environments <strong>may</strong> be equivalent. </p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">false</span></code> If two local environments are not equivalent. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3fly3env11Fingerprint5r_minEv">
<span id="_CPPv3NK3fly3env11Fingerprint5r_minEv"></span><span id="_CPPv2NK3fly3env11Fingerprint5r_minEv"></span><span id="fly::env::Fingerprint::r_minC"></span><span class="target" id="classfly_1_1env_1_1Fingerprint_1a69dad8e672210d20e52a143e9685a45d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">r_min</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><a class="headerlink" href="#_CPPv4NK3fly3env11Fingerprint5r_minEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get the smallest intra-atomic separation in this environment. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4IDpEN3fly3env11Fingerprint7rebuildEvRK8GeometryIDp1TE">
<span id="_CPPv3IDpEN3fly3env11Fingerprint7rebuildERK8GeometryIDp1TE"></span><span id="_CPPv2IDpEN3fly3env11Fingerprint7rebuildERK8GeometryIDp1TE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classfly_1_1env_1_1Fingerprint_1a285f2102a11a4f67e0c2ed387e44a48e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rebuild</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN3fly3env8GeometryE" title="fly::env::Geometry"><span class="n"><span class="pre">Geometry</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4IDpEN3fly3env11Fingerprint7rebuildEvRK8GeometryIDp1TE" title="fly::env::Fingerprint::rebuild::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">geo</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><a class="headerlink" href="#_CPPv4IDpEN3fly3env11Fingerprint7rebuildEvRK8GeometryIDp1TE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Rebuild the fingerprint from a <a class="reference internal" href="#classfly_1_1env_1_1Geometry"><span class="std std-ref">Geometry</span></a>. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN3fly3env11Fingerprint9serializeEvR7Archive">
<span id="_CPPv3I0EN3fly3env11Fingerprint9serializeER7Archive"></span><span id="_CPPv2I0EN3fly3env11Fingerprint9serializeER7Archive"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Archive</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classfly_1_1env_1_1Fingerprint_1a86becbc65fa1add64621a5bc1729a66d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">serialize</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN3fly3env11Fingerprint9serializeEvR7Archive" title="fly::env::Fingerprint::serialize::Archive"><span class="n"><span class="pre">Archive</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">archive</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN3fly3env11Fingerprint9serializeEvR7Archive" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Lib cereal serialization support. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="graph-hash">
<h3>Graph hash<a class="headerlink" href="#graph-hash" title="Permalink to this heading">#</a></h3>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env10canon_hashER8GeometryI5IndexEdNSt6size_tEP8GeometryI5IndexE">
<span id="_CPPv3N3fly3env10canon_hashER8GeometryI5IndexEdNSt6size_tEP8GeometryI5IndexE"></span><span id="_CPPv2N3fly3env10canon_hashER8GeometryI5IndexEdNSt6size_tEP8GeometryI5IndexE"></span><span id="fly::env::canon_hash__Geometry:Index:R.double.std::s.Geometry:Index:P"></span><span class="target" id="heuristics_8hpp_1a9eefed090b48dd5de5cdb10aa03351c0"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">fly</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">canon_hash</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4IDpEN3fly3env8GeometryE" title="fly::env::Geometry"><span class="n"><span class="pre">Geometry</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Index</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">geo</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_edge</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">c_max</span></span>, <a class="reference internal" href="#_CPPv4IDpEN3fly3env8GeometryE" title="fly::env::Geometry"><span class="n"><span class="pre">Geometry</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Index</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">scratch</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N3fly3env10canon_hashER8GeometryI5IndexEdNSt6size_tEP8GeometryI5IndexE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Reorder a geometry into a canonical order and produce a hash encoding the colours and topology of the geometry. </p>
<p>This functions builds a graph based representation of the geometry, encoding atoms as coloured nodes joined with edges if the atoms are closer than <code class="docutils literal notranslate"><span class="pre">r_edge</span></code>. This graph is then canonised using the nauty library (see: <a class="reference external" href="https://pallini.di.uniroma1.it/">https://pallini.di.uniroma1.it/</a>) and a hash is derived from the canonical adjacency matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>geo</strong> – The geometry to be reordered. </p></li>
<li><p><strong>r_edge</strong> – The edge length used to determine if atoms in the geometry are bonded in the graph representation. </p></li>
<li><p><strong>c_max</strong> – The number of colours in the simulation, equal to <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">TypeMap::num_types()</span></code>. </p></li>
<li><p><strong>scratch</strong> – An optional parameter, if provided and <code class="docutils literal notranslate"><span class="pre">scratch-&gt;size()</span> <span class="pre">&gt;=</span> <span class="pre">geo.size()</span></code> then no allocation will occur. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="mechanisms">
<h2>Mechanisms<a class="headerlink" href="#mechanisms" title="Permalink to this heading">#</a></h2>
<p>File: <code class="docutils literal notranslate"><span class="pre">libfly/env/mechanisms.hpp</span></code></p>
<p>Representations of mechanisms. </p>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9MechanismE">
<span id="_CPPv3N3fly3env9MechanismE"></span><span id="_CPPv2N3fly3env9MechanismE"></span><span id="fly::env::Mechanism"></span><span class="target" id="classfly_1_1env_1_1Mechanism"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Mechanism</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env9MechanismE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>A representation of a local mechanism containing the the displacements of the atoms in a LE. </p>
<p>A mechanism describes the displacement vectors from a LE to an adjacent minima via a SP.</p>
<p><a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Frozen"><span class="std std-ref">Frozen</span></a> atoms must have a displacement equal to <code class="docutils literal notranslate"><span class="pre">Vec::Zero()</span></code>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN3fly3env9Mechanism9serializeEvR7Archive">
<span id="_CPPv3I0EN3fly3env9Mechanism9serializeER7Archive"></span><span id="_CPPv2I0EN3fly3env9Mechanism9serializeER7Archive"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Archive</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classfly_1_1env_1_1Mechanism_1ad59df95e6fca4d448752840d111bf3a8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">serialize</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN3fly3env9Mechanism9serializeEvR7Archive" title="fly::env::Mechanism::serialize::Archive"><span class="n"><span class="pre">Archive</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">archive</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN3fly3env9Mechanism9serializeEvR7Archive" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Lib cereal serialization support. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Mechanism7barrierE">
<span id="_CPPv3N3fly3env9Mechanism7barrierE"></span><span id="_CPPv2N3fly3env9Mechanism7barrierE"></span><span id="fly::env::Mechanism::barrier__double"></span><span class="target" id="classfly_1_1env_1_1Mechanism_1a8b655c0e8194b12940f17298ea92fe9c"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">barrier</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env9Mechanism7barrierE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Energy barrier (<code class="docutils literal notranslate"><span class="pre">eSp</span> <span class="pre">-</span> <span class="pre">e0</span></code>). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Mechanism5deltaE">
<span id="_CPPv3N3fly3env9Mechanism5deltaE"></span><span id="_CPPv2N3fly3env9Mechanism5deltaE"></span><span id="fly::env::Mechanism::delta__double"></span><span class="target" id="classfly_1_1env_1_1Mechanism_1a77d828e70094d3965d78abe25a2fd7ba"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">delta</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env9Mechanism5deltaE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Energy change (eF - e0). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Mechanism9delta_fwdE">
<span id="_CPPv3N3fly3env9Mechanism9delta_fwdE"></span><span id="_CPPv2N3fly3env9Mechanism9delta_fwdE"></span><span id="fly::env::Mechanism::delta_fwd__system::VoS:Delta:"></span><span class="target" id="classfly_1_1env_1_1Mechanism_1a0a88948057e32019f149671c0e2fab96"></span><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Delta</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">delta_fwd</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env9Mechanism9delta_fwdE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Displacement vectors from initial to final. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Mechanism8delta_spE">
<span id="_CPPv3N3fly3env9Mechanism8delta_spE"></span><span id="_CPPv2N3fly3env9Mechanism8delta_spE"></span><span id="fly::env::Mechanism::delta_sp__system::VoS:Delta:"></span><span class="target" id="classfly_1_1env_1_1Mechanism_1a694f29ebcb9282467890dc7221f6cc37"></span><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3VoSE" title="fly::system::VoS"><span class="n"><span class="pre">VoS</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Delta</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">delta_sp</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env9Mechanism8delta_spE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Displacement vectors from initial to saddle-point. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Mechanism7err_fwdE">
<span id="_CPPv3N3fly3env9Mechanism7err_fwdE"></span><span id="_CPPv2N3fly3env9Mechanism7err_fwdE"></span><span id="fly::env::Mechanism::err_fwd__double"></span><span class="target" id="classfly_1_1env_1_1Mechanism_1a4d50fd9165c46e3e4ac37a2fd7a7fc0b"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">err_fwd</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">numeric_limits</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">max</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Mechanism7err_fwdE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Forward reconstruction error. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Mechanism6err_spE">
<span id="_CPPv3N3fly3env9Mechanism6err_spE"></span><span id="_CPPv2N3fly3env9Mechanism6err_spE"></span><span id="fly::env::Mechanism::err_sp__double"></span><span class="target" id="classfly_1_1env_1_1Mechanism_1abb2953ec61231e80b237876a91ce6aa3"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">err_sp</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">numeric_limits</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">max</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Mechanism6err_spE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Saddle point reconstruction error. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Mechanism11kinetic_preE">
<span id="_CPPv3N3fly3env9Mechanism11kinetic_preE"></span><span id="_CPPv2N3fly3env9Mechanism11kinetic_preE"></span><span id="fly::env::Mechanism::kinetic_pre__double"></span><span class="target" id="classfly_1_1env_1_1Mechanism_1ad37d83adf7932726d7eb62d277fc20fb"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">kinetic_pre</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env9Mechanism11kinetic_preE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Arrhenius pre factor. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Mechanism10poison_fwdE">
<span id="_CPPv3N3fly3env9Mechanism10poison_fwdE"></span><span id="_CPPv2N3fly3env9Mechanism10poison_fwdE"></span><span id="fly::env::Mechanism::poison_fwd__b"></span><span class="target" id="classfly_1_1env_1_1Mechanism_1af567f68d3ba08cbcb0f6dc33b31c7719"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">poison_fwd</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Mechanism10poison_fwdE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>If true this mechanism’s final state cannot be reconstructed. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Mechanism9poison_spE">
<span id="_CPPv3N3fly3env9Mechanism9poison_spE"></span><span id="_CPPv2N3fly3env9Mechanism9poison_spE"></span><span id="fly::env::Mechanism::poison_sp__b"></span><span class="target" id="classfly_1_1env_1_1Mechanism_1ae0c3c58a6120826589d33126aea13f0e"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">poison_sp</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Mechanism9poison_spE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>If true this mechanism’s SP cannot be reconstructed. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="the-catalogue">
<h2>The catalogue<a class="headerlink" href="#the-catalogue" title="Permalink to this heading">#</a></h2>
<p>File: <code class="docutils literal notranslate"><span class="pre">libfly/env/catalogue.hpp</span></code></p>
<p>Classes responsible for mapping local environments to mechanisms. </p>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9CatalogueE">
<span id="_CPPv3N3fly3env9CatalogueE"></span><span id="_CPPv2N3fly3env9CatalogueE"></span><span id="fly::env::Catalogue"></span><span class="target" id="classfly_1_1env_1_1Catalogue"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Catalogue</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env9CatalogueE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>The <a class="reference internal" href="#classfly_1_1env_1_1Catalogue"><span class="std std-ref">Catalogue</span></a> is a mapping from <code class="docutils literal notranslate"><a class="reference internal" href="#classfly_1_1env_1_1Geometry"><span class="std std-ref"><span class="pre">Geometry</span></span></a></code> to local environments and mechanisms. </p>
<p>The <a class="reference internal" href="#classfly_1_1env_1_1Catalogue"><span class="std std-ref">Catalogue</span></a> is responsible for building geometries from a <code class="docutils literal notranslate"><span class="pre">Supercell</span></code> and associating them with equivalent, historically-seen geometries via a three step matching process detailed in <code class="docutils literal notranslate"><a class="reference internal" href="#classfly_1_1env_1_1Catalogue_1a9e149ba31514a9ca94170f04038e83fa"><span class="std std-ref"><span class="pre">Catalogue::rebuild()</span></span></a></code>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue9CatalogueERK7Options">
<span id="_CPPv3N3fly3env9Catalogue9CatalogueERK7Options"></span><span id="_CPPv2N3fly3env9Catalogue9CatalogueERK7Options"></span><span id="fly::env::Catalogue::Catalogue__OptionsCR"></span><span class="target" id="classfly_1_1env_1_1Catalogue_1aa3c2406ec0b75d2dae1c2cd48611772b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Catalogue</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N3fly3env9Catalogue7OptionsE" title="fly::env::Catalogue::Options"><span class="n"><span class="pre">Options</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">opt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue9CatalogueERK7Options" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Construct a new <a class="reference internal" href="#classfly_1_1env_1_1Catalogue"><span class="std std-ref">Catalogue</span></a> object. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue9CatalogueERK7OptionsRNSt8ifstreamE">
<span id="_CPPv3N3fly3env9Catalogue9CatalogueERK7OptionsRNSt8ifstreamE"></span><span id="_CPPv2N3fly3env9Catalogue9CatalogueERK7OptionsRNSt8ifstreamE"></span><span id="fly::env::Catalogue::Catalogue__OptionsCR.std::ifstreamR"></span><span class="target" id="classfly_1_1env_1_1Catalogue_1a6b7a9eb65775817c1eda97e3d8bec8d3"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Catalogue</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N3fly3env9Catalogue7OptionsE" title="fly::env::Catalogue::Options"><span class="n"><span class="pre">Options</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">opt</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ifstream</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">fin</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue9CatalogueERK7OptionsRNSt8ifstreamE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Load a catalogue from a binary archive. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3fly3env9Catalogue14calc_self_symsEi">
<span id="_CPPv3NK3fly3env9Catalogue14calc_self_symsEi"></span><span id="_CPPv2NK3fly3env9Catalogue14calc_self_symsEi"></span><span id="fly::env::Catalogue::calc_self_syms__iC"></span><span class="target" id="classfly_1_1env_1_1Catalogue_1a8604404c6d5f29686b77c733787ffb76"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">calc_self_syms</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N3fly3env9Catalogue11SelfSymetryE" title="fly::env::Catalogue::SelfSymetry"><span class="n"><span class="pre">SelfSymetry</span></span></a><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4NK3fly3env9Catalogue14calc_self_symsEi" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Compute the permutation and transformation of the <code class="docutils literal notranslate"><span class="pre">i</span></code>th geometry that maps it onto itself. </p>
<p>This is according to the <code class="docutils literal notranslate"><span class="pre">delta_max()</span></code> of the environment it is currently equivalent to. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3fly3env9Catalogue4dumpERNSt8ofstreamE">
<span id="_CPPv3NK3fly3env9Catalogue4dumpERNSt8ofstreamE"></span><span id="_CPPv2NK3fly3env9Catalogue4dumpERNSt8ofstreamE"></span><span id="fly::env::Catalogue::dump__std::ofstreamRC"></span><span class="target" id="classfly_1_1env_1_1Catalogue_1a3c0cc893297c1930e41785f8031cce01"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dump</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">ofstream</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">fout</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><a class="headerlink" href="#_CPPv4NK3fly3env9Catalogue4dumpERNSt8ofstreamE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Write this catalogue to a binary archive. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3fly3env9Catalogue7get_geoEi">
<span id="_CPPv3NK3fly3env9Catalogue7get_geoEi"></span><span id="_CPPv2NK3fly3env9Catalogue7get_geoEi"></span><span id="fly::env::Catalogue::get_geo__iC"></span><span class="target" id="classfly_1_1env_1_1Catalogue_1a2aac75959954efef0680c919030c7f51"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_geo</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4IDpEN3fly3env8GeometryE" title="fly::env::Geometry"><span class="n"><span class="pre">Geometry</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Index</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="p"><span class="pre">&amp;</span></span><a class="headerlink" href="#_CPPv4NK3fly3env9Catalogue7get_geoEi" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get a view of the (indexed) geometry, in canonical order, around atom <code class="docutils literal notranslate"><span class="pre">i</span></code>. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3fly3env9Catalogue7get_refEi">
<span id="_CPPv3NK3fly3env9Catalogue7get_refEi"></span><span id="_CPPv2NK3fly3env9Catalogue7get_refEi"></span><span id="fly::env::Catalogue::get_ref__iC"></span><span class="target" id="classfly_1_1env_1_1Catalogue_1adc87bd3ac4d049bb0b5b4129841d7f05"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_ref</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N3fly3env9Catalogue3EnvE" title="fly::env::Catalogue::Env"><span class="n"><span class="pre">Env</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="p"><span class="pre">&amp;</span></span><a class="headerlink" href="#_CPPv4NK3fly3env9Catalogue7get_refEi" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get the reference geometry stored in the catalogue that is equivalent to the geometry around atom <code class="docutils literal notranslate"><span class="pre">i</span></code>. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3fly3env9Catalogue8num_keysEv">
<span id="_CPPv3NK3fly3env9Catalogue8num_keysEv"></span><span id="_CPPv2NK3fly3env9Catalogue8num_keysEv"></span><span id="fly::env::Catalogue::num_keysC"></span><span class="target" id="classfly_1_1env_1_1Catalogue_1ab736500a4c03d88c4fd4cc9a4d12af7e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_keys</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK3fly3env9Catalogue8num_keysEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get the number of discrete keys in the catalogue. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue8optimizeEv">
<span id="_CPPv3N3fly3env9Catalogue8optimizeEv"></span><span id="_CPPv2N3fly3env9Catalogue8optimizeEv"></span><span id="fly::env::Catalogue::optimize"></span><span class="target" id="classfly_1_1env_1_1Catalogue_1aac349c72ab94500b89518706f4ba8c1b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">optimize</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue8optimizeEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Re-order the catalogue into frequency order. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0DpEN3fly3env9Catalogue7rebuildENSt6vectorIiEERKN6system9SupercellI3MapDp1TEEi">
<span id="_CPPv3I0DpEN3fly3env9Catalogue7rebuildERKN6system9SupercellI3MapDp1TEEi"></span><span id="_CPPv2I0DpEN3fly3env9Catalogue7rebuildERKN6system9SupercellI3MapDp1TEEi"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Map</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classfly_1_1env_1_1Catalogue_1a9e149ba31514a9ca94170f04038e83fa"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rebuild</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4I0DpEN3fly6system9SupercellE" title="fly::system::Supercell"><span class="n"><span class="pre">Supercell</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0DpEN3fly3env9Catalogue7rebuildENSt6vectorIiEERKN6system9SupercellI3MapDp1TEEi" title="fly::env::Catalogue::rebuild::Map"><span class="n"><span class="pre">Map</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0DpEN3fly3env9Catalogue7rebuildENSt6vectorIiEERKN6system9SupercellI3MapDp1TEEi" title="fly::env::Catalogue::rebuild::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cell</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_threads</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4I0DpEN3fly3env9Catalogue7rebuildENSt6vectorIiEERKN6system9SupercellI3MapDp1TEEi" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Build the geometries and associate them with equivalent, historically-seen geometries. </p>
<p><p>This occurs via a three step matching process:</p>
<ol class="arabic simple">
<li><p>The new geometries are canonised (based on their graph representation) and a discrete key generated.</p></li>
<li><p>Geometries with equal discrete keys are compared for equivalence of their fingerprints.</p></li>
<li><p>If they are equivalent under (2) they are compared for equivalence via <code class="docutils literal notranslate"><span class="pre">geometry::permute_onto()</span></code>.</p></li>
</ol>
<p>Any new geometries that have not been encountered before are inserted into the catalogue and the index
of the atom atom which the unknown geometry is centred on is returned.</p>
<p>This process is deterministic, providing none of the reference geometries are modified (allowing new
ones to be inserted) the same match will always be returned.</p>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell</strong> – The supercell, must have the <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Position"><span class="std std-ref">Position</span></a>, <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1TypeID"><span class="std std-ref">TypeID</span></a> and <a class="reference internal" href="system.html#structfly_1_1builtin__properties_1_1Frozen"><span class="std std-ref">Frozen</span></a> properties. </p></li>
<li><p><strong>num_threads</strong> – The number of openMP threads to use. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">std::vector</span></code> of indices corresponding to the new geometries. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0DpEN3fly3env9Catalogue11reconstructE3MatN6system3SoAIR8PositionEERK9MechanismiRKN6system9SupercellI3MapDp1TEEbi">
<span id="_CPPv3I0DpEN3fly3env9Catalogue11reconstructEN6system3SoAIR8PositionEERK9MechanismiRKN6system9SupercellI3MapDp1TEEbi"></span><span id="_CPPv2I0DpEN3fly3env9Catalogue11reconstructEN6system3SoAIR8PositionEERK9MechanismiRKN6system9SupercellI3MapDp1TEEbi"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Map</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classfly_1_1env_1_1Catalogue_1a164248f317207bf371f25cae49021b4c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reconstruct</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4IDpEN3fly6system3SoAE" title="fly::system::SoA"><span class="n"><span class="pre">SoA</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Position</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out</span></span>, <a class="reference internal" href="#_CPPv4N3fly3env9MechanismE" title="fly::env::Mechanism"><span class="n"><span class="pre">Mechanism</span></span></a><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mech</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="n"><span class="pre">system</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="system.html#_CPPv4I0DpEN3fly6system9SupercellE" title="fly::system::Supercell"><span class="n"><span class="pre">Supercell</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0DpEN3fly3env9Catalogue11reconstructE3MatN6system3SoAIR8PositionEERK9MechanismiRKN6system9SupercellI3MapDp1TEEbi" title="fly::env::Catalogue::reconstruct::Map"><span class="n"><span class="pre">Map</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0DpEN3fly3env9Catalogue11reconstructE3MatN6system3SoAIR8PositionEERK9MechanismiRKN6system9SupercellI3MapDp1TEEbi" title="fly::env::Catalogue::reconstruct::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">in</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">in_ready_state</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_threads</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="utility.html#_CPPv4N3fly3MatE" title="fly::Mat"><span class="n"><span class="pre">Mat</span></span></a><a class="headerlink" href="#_CPPv4I0DpEN3fly3env9Catalogue11reconstructE3MatN6system3SoAIR8PositionEERK9MechanismiRKN6system9SupercellI3MapDp1TEEbi" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Reconstruct a mechanisms <code class="docutils literal notranslate"><span class="pre">mech</span></code> onto the <code class="docutils literal notranslate"><span class="pre">i</span></code> atom of <code class="docutils literal notranslate"><span class="pre">in</span></code>. </p>
<p>Reconstruct a mechanisms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> – Write the reconstructed position here. </p></li>
<li><p><strong>mech</strong> – The mechanism to reconstruct. </p></li>
<li><p><strong>i</strong> – The index of the atom to reconstruct the mechanism onto. </p></li>
<li><p><strong>in</strong> – The initial state of the system before the reconstruction. </p></li>
<li><p><strong>in_ready_state</strong> – If <code class="docutils literal notranslate"><span class="pre">true</span></code> this function will assume the currently loaded geo/ref of the <code class="docutils literal notranslate"><span class="pre">i</span></code>th atom match the input <code class="docutils literal notranslate"><span class="pre">in</span></code> otherwise, the geometry will be rebuilt. </p></li>
<li><p><strong>num_threads</strong> – Number of openMP threads to use. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mat The matrix that transforms <code class="docutils literal notranslate"><span class="pre">mech</span></code> before reconstruction onto out. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue10refine_tolEid">
<span id="_CPPv3N3fly3env9Catalogue10refine_tolEid"></span><span id="_CPPv2N3fly3env9Catalogue10refine_tolEid"></span><span id="fly::env::Catalogue::refine_tol__i.double"></span><span class="target" id="classfly_1_1env_1_1Catalogue_1a7b5dbc2927e29acda6fee056c44aa09d"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">refine_tol</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">min_delta</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue10refine_tolEid" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Tighten the tolerance of the <code class="docutils literal notranslate"><span class="pre">i</span></code>th environment. </p>
<p>This is done such that the current geometry no longer matches the reference or <code class="docutils literal notranslate"><span class="pre">delta_max</span> <span class="pre">=</span> <span class="pre">min_delta</span></code>. Additionally, this function resets the frequency and false positive counters of the reference environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The new <code class="docutils literal notranslate"><span class="pre">delta_max</span></code> of the environment reference environment that atom <code class="docutils literal notranslate"><span class="pre">i</span></code> was equivalent to. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN3fly3env9Catalogue9serializeEvR7Archive">
<span id="_CPPv3I0EN3fly3env9Catalogue9serializeER7Archive"></span><span id="_CPPv2I0EN3fly3env9Catalogue9serializeER7Archive"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Archive</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="classfly_1_1env_1_1Catalogue_1ad30a7192bef60a0a03c11be7c8f24d26"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">serialize</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN3fly3env9Catalogue9serializeEvR7Archive" title="fly::env::Catalogue::serialize::Archive"><span class="n"><span class="pre">Archive</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">archive</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN3fly3env9Catalogue9serializeEvR7Archive" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Lib cereal serialization support. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue9set_mechsEiRKNSt6vectorI9MechanismEE">
<span id="_CPPv3N3fly3env9Catalogue9set_mechsEiRKNSt6vectorI9MechanismEE"></span><span id="_CPPv2N3fly3env9Catalogue9set_mechsEiRKNSt6vectorI9MechanismEE"></span><span id="fly::env::Catalogue::set_mechs__i.std::vector:Mechanism:CR"></span><span class="target" id="classfly_1_1env_1_1Catalogue_1aaafbf4bc8b431b1877b3219b84b65d9e"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_mechs</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N3fly3env9MechanismE" title="fly::env::Mechanism"><span class="n"><span class="pre">Mechanism</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">m</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue9set_mechsEiRKNSt6vectorI9MechanismEE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Set the vector of <code class="docutils literal notranslate"><a class="reference internal" href="#classfly_1_1env_1_1Mechanism"><span class="std std-ref"><span class="pre">Mechanism</span></span></a></code>s. </p>
<p>Pre-condition, this may only be called once per LE. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3fly3env9Catalogue4sizeEv">
<span id="_CPPv3NK3fly3env9Catalogue4sizeEv"></span><span id="_CPPv2NK3fly3env9Catalogue4sizeEv"></span><span id="fly::env::Catalogue::sizeC"></span><span class="target" id="classfly_1_1env_1_1Catalogue_1a0a2d98d2cad6758f30ef9b7316447db0"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK3fly3env9Catalogue4sizeEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get the number of local environments in the catalogue. </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue3EnvE">
<span id="_CPPv3N3fly3env9Catalogue3EnvE"></span><span id="_CPPv2N3fly3env9Catalogue3EnvE"></span><span id="fly::env::Catalogue::Env"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Env"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Env</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">private</span></span><span class="w"> </span><span class="n"><span class="pre">fly</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">env</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4IDpEN3fly3env8GeometryE" title="fly::env::Geometry"><span class="n"><span class="pre">Geometry</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="p"><span class="pre">&gt;</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue3EnvE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>The representation of a local environment in the catalogue. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue3Env3EnvEv">
<span id="_CPPv3N3fly3env9Catalogue3Env3EnvEv"></span><span id="_CPPv2N3fly3env9Catalogue3Env3EnvEv"></span><span id="fly::env::Catalogue::Env::Env"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Env_1a61842e594456459f5a9dbf4eac0ce26b"></span><span class="sig-name descname"><span class="n"><span class="pre">Env</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue3Env3EnvEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>For lib cereal. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3fly3env9Catalogue3Env9cat_indexEv">
<span id="_CPPv3NK3fly3env9Catalogue3Env9cat_indexEv"></span><span id="_CPPv2NK3fly3env9Catalogue3Env9cat_indexEv"></span><span id="fly::env::Catalogue::Env::cat_indexC"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Env_1a3b62d20686c56bf16b1461a8717fa14a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cat_index</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><a class="headerlink" href="#_CPPv4NK3fly3env9Catalogue3Env9cat_indexEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get an index (unique to this environment) in the catalogue. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3fly3env9Catalogue3Env9delta_maxEv">
<span id="_CPPv3NK3fly3env9Catalogue3Env9delta_maxEv"></span><span id="_CPPv2NK3fly3env9Catalogue3Env9delta_maxEv"></span><span id="fly::env::Catalogue::Env::delta_maxC"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Env_1a4ab7e393e4a48060afaeed1071bf10a1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">delta_max</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><a class="headerlink" href="#_CPPv4NK3fly3env9Catalogue3Env9delta_maxEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get the internal maximum norm between this environment and a geometry for them to be considered equivalent. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3fly3env9Catalogue3Env9get_mechsEv">
<span id="_CPPv3NK3fly3env9Catalogue3Env9get_mechsEv"></span><span id="_CPPv2NK3fly3env9Catalogue3Env9get_mechsEv"></span><span id="fly::env::Catalogue::Env::get_mechsC"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Env_1a52308649e9254b422f312bb9102731ae"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_mechs</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N3fly3env9MechanismE" title="fly::env::Mechanism"><span class="n"><span class="pre">Mechanism</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="p"><span class="pre">&amp;</span></span><a class="headerlink" href="#_CPPv4NK3fly3env9Catalogue3Env9get_mechsEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Get a vector of the <code class="docutils literal notranslate"><a class="reference internal" href="#classfly_1_1env_1_1Mechanism"><span class="std std-ref"><span class="pre">Mechanism</span></span></a></code>s centred on this environment. </p>
<p>Pre-condition, <a class="reference internal" href="#classfly_1_1env_1_1Catalogue_1aaafbf4bc8b431b1877b3219b84b65d9e"><span class="std std-ref">set_mechs()</span></a> must have been called on this <code class="docutils literal notranslate"><a class="reference internal" href="#structfly_1_1env_1_1Catalogue_1_1Env"><span class="std std-ref"><span class="pre">Env</span></span></a></code>. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK3fly3env9Catalogue3Env7ref_geoEv">
<span id="_CPPv3NK3fly3env9Catalogue3Env7ref_geoEv"></span><span id="_CPPv2NK3fly3env9Catalogue3Env7ref_geoEv"></span><span id="fly::env::Catalogue::Env::ref_geoC"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Env_1a95b03f80b655a16686ba6f013e2670b8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ref_geo</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="o"><span class="pre">-&gt;</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4IDpEN3fly3env8GeometryE" title="fly::env::Geometry"><span class="n"><span class="pre">Geometry</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="p"><span class="pre">&amp;</span></span><a class="headerlink" href="#_CPPv4NK3fly3env9Catalogue3Env7ref_geoEv" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Fetch the reference geometry this environment represents. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN3fly3env9Catalogue3Env9serializeEvR7Archive">
<span id="_CPPv3I0EN3fly3env9Catalogue3Env9serializeER7Archive"></span><span id="_CPPv2I0EN3fly3env9Catalogue3Env9serializeER7Archive"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Archive</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Env_1abc0912b96a5c5ea09743d8d1cbba0064"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">serialize</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN3fly3env9Catalogue3Env9serializeEvR7Archive" title="fly::env::Catalogue::Env::serialize::Archive"><span class="n"><span class="pre">Archive</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">archive</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN3fly3env9Catalogue3Env9serializeEvR7Archive" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Lib cereal serialization support. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue7OptionsE">
<span id="_CPPv3N3fly3env9Catalogue7OptionsE"></span><span id="_CPPv2N3fly3env9Catalogue7OptionsE"></span><span id="fly::env::Catalogue::Options"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Options"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Options</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue7OptionsE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Used to configure the catalogue. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN3fly3env9Catalogue7Options9serializeEvR7Archive">
<span id="_CPPv3I0EN3fly3env9Catalogue7Options9serializeER7Archive"></span><span id="_CPPv2I0EN3fly3env9Catalogue7Options9serializeER7Archive"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Archive</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Options_1acabd4d33ab34ca5ddc34dfcebe56c35e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">serialize</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN3fly3env9Catalogue7Options9serializeEvR7Archive" title="fly::env::Catalogue::Options::serialize::Archive"><span class="n"><span class="pre">Archive</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">archive</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN3fly3env9Catalogue7Options9serializeEvR7Archive" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Lib cereal serialization support. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue7Options5debugE">
<span id="_CPPv3N3fly3env9Catalogue7Options5debugE"></span><span id="_CPPv2N3fly3env9Catalogue7Options5debugE"></span><span id="fly::env::Catalogue::Options::debug__b"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Options_1a71514c0775e75bb5b3fc0191e290e761"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">debug</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue7Options5debugE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>If true prints debugging info. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue7Options9delta_maxE">
<span id="_CPPv3N3fly3env9Catalogue7Options9delta_maxE"></span><span id="_CPPv2N3fly3env9Catalogue7Options9delta_maxE"></span><span id="fly::env::Catalogue::Options::delta_max__double"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Options_1a7b750bd31ed851f85a9e9f3261d8bbe7"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">delta_max</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">numeric_limits</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">max</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue7Options9delta_maxE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Initial maximum difference in L2 norm between LEs for them to be considered the same. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue7Options13min_delta_maxE">
<span id="_CPPv3N3fly3env9Catalogue7Options13min_delta_maxE"></span><span id="_CPPv2N3fly3env9Catalogue7Options13min_delta_maxE"></span><span id="fly::env::Catalogue::Options::min_delta_max__double"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Options_1ab4f5cf59189f7464f5573bbbaf70ae9a"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">min_delta_max</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1e-7</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue7Options13min_delta_maxE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Minimum value of delta_max during refinement (smaller is considered an error). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue7Options8overfuzzE">
<span id="_CPPv3N3fly3env9Catalogue7Options8overfuzzE"></span><span id="_CPPv2N3fly3env9Catalogue7Options8overfuzzE"></span><span id="fly::env::Catalogue::Options::overfuzz__double"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Options_1a4c781213a6294cd7f3451ae242285c5b"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">overfuzz</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.5</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue7Options8overfuzzE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Smaller to decrease false positives during fingerprint equivalence but, values &lt; 1.0 introduce false negatives. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue7Options6r_edgeE">
<span id="_CPPv3N3fly3env9Catalogue7Options6r_edgeE"></span><span id="_CPPv2N3fly3env9Catalogue7Options6r_edgeE"></span><span id="fly::env::Catalogue::Options::r_edge__double"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Options_1a4b8de39f179c2d81d4442524a65f7d54"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">r_edge</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">3.0</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue7Options6r_edgeE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Maximum distance for atoms to be considered connected in the canonisation neighbour graph. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue7Options5r_envE">
<span id="_CPPv3N3fly3env9Catalogue7Options5r_envE"></span><span id="_CPPv2N3fly3env9Catalogue7Options5r_envE"></span><span id="fly::env::Catalogue::Options::r_env__double"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1Options_1abaa5983278a7b09998ee1c0b526383e3"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">r_env</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">5.2</span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue7Options5r_envE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Radius of a local environment. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue11SelfSymetryE">
<span id="_CPPv3N3fly3env9Catalogue11SelfSymetryE"></span><span id="_CPPv2N3fly3env9Catalogue11SelfSymetryE"></span><span id="fly::env::Catalogue::SelfSymetry"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1SelfSymetry"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SelfSymetry</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue11SelfSymetryE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Describes a transformation + permutation that maps a geometry onto itself. </p>
<p>Explicitly this a the transformation such that: </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue11SelfSymetry1OE">
<span id="_CPPv3N3fly3env9Catalogue11SelfSymetry1OE"></span><span id="_CPPv2N3fly3env9Catalogue11SelfSymetry1OE"></span><span id="fly::env::Catalogue::SelfSymetry::O__Mat"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1SelfSymetry_1a5722c38968a7c057b3816562e81eef0c"></span><a class="reference internal" href="utility.html#_CPPv4N3fly3MatE" title="fly::Mat"><span class="n"><span class="pre">Mat</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">O</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue11SelfSymetry1OE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Transformation matrix. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N3fly3env9Catalogue11SelfSymetry4permE">
<span id="_CPPv3N3fly3env9Catalogue11SelfSymetry4permE"></span><span id="_CPPv2N3fly3env9Catalogue11SelfSymetry4permE"></span><span id="fly::env::Catalogue::SelfSymetry::perm__std::vector:Index::scalar_t:"></span><span class="target" id="structfly_1_1env_1_1Catalogue_1_1SelfSymetry_1a843d0e3fd149053e7bafcd82630df281"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Index</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">scalar_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">perm</span></span></span><a class="headerlink" href="#_CPPv4N3fly3env9Catalogue11SelfSymetry4permE" title="Permalink to this definition">#</a><br /></dt>
<dd><p>Permutation. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="io.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Input/Output (IO)</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="neighbour.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Neighbours</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, ConorWilliams
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/ConorWilliams/openFLY" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Environments</a><ul>
<li><a class="reference internal" href="#geometry">Geometry</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#geometry-class">Geometry class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#heuristics">Heuristics</a><ul>
<li><a class="reference internal" href="#fingerprints">Fingerprints</a></li>
<li><a class="reference internal" href="#graph-hash">Graph hash</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mechanisms">Mechanisms</a></li>
<li><a class="reference internal" href="#the-catalogue">The catalogue</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/tabs.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>